% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Batch_effect_functions.R
\name{anova_betadine_tidy_function}
\alias{anova_betadine_tidy_function}
\title{Run Tidy ANOVA for Multiple Batch Annotations}
\usage{
anova_betadine_tidy_function(m, meta, annotations)
}
\arguments{
\item{m}{Numeric matrix.   Expression data with features in rows and samples
in columns.  Typically from \code{Biobase::exprs(ExpressionSet)}.}

\item{meta}{Data frame. Sample metadata with annotations in columns and
samples in rows.  Typically from \code{Biobase::pData(ExpressionSet)}.}

\item{annotations}{Character vector.  Column names from \code{meta} to test for
batch effects.  Each annotation is tested independently.}
}
\value{
Data frame with ANOVA results for each annotation.   Columns include:
\describe{
\item{Annotation}{Name of the tested annotation column}
\item{df}{Degrees of freedom}
\item{sumsq}{Sum of squares}
\item{meansq}{Mean sum of squares}
\item{statistic}{F-statistic}
\item{p.value}{P-value from ANOVA test}
}
All numeric values are rounded to 3 significant figures.
Returns empty data frame if computation fails.
}
\description{
Performs ANOVA tests across multiple phenoData annotations to identify
batch effects in expression data.  Returns a tidy data frame with test
statistics for each annotation.
}
\details{
This function wraps \code{anova_betadine_function()} and applies it to multiple
annotations. It uses \code{broom::tidy()} to convert ANOVA results to a tidy
format and filters for the "Groups" term.

Error handling: If ANOVA computation fails for any annotation, a warning
message is printed with the annotation name, and that annotation is skipped.
If all annotations fail, an empty data frame is returned.
}
\note{
Original location: i-Ome-AI batch correction workflow
}
\examples{
\dontrun{
# Using ExpressionSet
library(Biobase)
data(sample_ExpressionSet)

m <- exprs(sample_ExpressionSet)
meta <- pData(sample_ExpressionSet)

# Test multiple annotations
annotations <- c("sex", "type", "score")
results <- anova_betadine_tidy_function(m, meta, annotations)

# View significant batch effects
results \%>\%
  filter(p.value < 0.05) \%>\%
  arrange(p.value)
}

}
\seealso{
\code{\link{anova_betadine_function}} for single annotation ANOVA
}
