% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pseudoarray_functions.R
\name{QC_pseudo_array_grid_function}
\alias{QC_pseudo_array_grid_function}
\title{Generate Pseudo Array Grid for Quality Control}
\usage{
QC_pseudo_array_grid_function(
  sample,
  datCollate,
  wavelength,
  data_type = c("all"),
  scale = "RFU",
  point_size = 0.75,
  show_flags = TRUE,
  flagged_proteins = NULL,
  selected_proteins = NULL,
  scale_mode = "auto_per_plot",
  custom_min = NULL,
  custom_max = NULL
)
}
\arguments{
\item{sample}{Character string specifying the sample name}

\item{datCollate}{List object containing experiment data with structure:
\itemize{
\item \code{manifest}: Data frame with sample information
\item \code{data$RawData}: Data frame with raw GPR data
\item \code{data$Data}: Data frame with protein annotations
\item \code{param$Wavelength}: Character string ("532" or "635") specifying wavelength
}}

\item{data_type}{Character vector specifying which data types to include.
Options: c('all'), c('feature'), c('feature', 'ctrl'), etc.
Default is c('all') which includes 'feature' and 'ctrl'}

\item{scale}{Character string specifying scale type: "RFU" for linear or
"Log2" for log2-transformed. Default is "RFU"}

\item{point_size}{Numeric value for base point size. Default is 0.75}

\item{show_flags}{Logical indicating whether to show quality flags as different
point shapes in the NetI plot. Default is TRUE}

\item{flagged_proteins}{Character vector of protein names that should be flagged
in the NetI plot. Default is NULL}

\item{selected_proteins}{Character vector of protein names that should be highlighted
in the NetI plot. Default is NULL}

\item{custom_min}{Numeric value for custom minimum scale limit. Default is NULL}

\item{custom_max}{Numeric value for custom maximum scale limit. Default is NULL}

\item{use_custom_scale}{Logical indicating whether to use custom scale limits
for consistent scaling across plots. Default is FALSE}
}
\value{
A named list with three ggplot objects:
\item{BG}{Background intensity pseudo array plot}
\item{FG}{Foreground intensity pseudo array plot}
\item{NetI}{Net intensity pseudo array plot (with legend removed)}
}
\description{
Creates a set of three pseudo array plots (Background, Foreground, and Net Intensity)
for a single sample, suitable for quality control visualization in a grid layout.
}
\details{
This function is designed for quality control dashboards where you want to
display BG, FG, and NetI side-by-side for comparison. All three plots use
the same scale type (RFU or Log2) and data type filters for consistency.

The NetI plot has its legend removed to save space in grid layouts, but
the BG and FG plots retain their legends.

All three plots share the same color scale limits (if use_custom_scale = TRUE)
to ensure comparable color intensity across the trio.
}
\examples{
\dontrun{
# Generate QC pseudo array grid
plots <- QC_pseudo_array_grid_function("Sample1", datCollate,
                                        data_type = c('all'),
                                        scale = "RFU")

# Display in grid using cowplot or patchwork
library(cowplot)
plot_grid(plots$BG, plots$FG, plots$NetI, nrow = 1)

# Or with patchwork
library(patchwork)
plots$BG | plots$FG | plots$NetI

# With log2 scale and custom limits
plots <- QC_pseudo_array_grid_function("Sample1", datCollate,
                                        data_type = c('feature'),
                                        scale = "Log2",
                                        use_custom_scale = TRUE,
                                        custom_min = 0,
                                        custom_max = 16)

# In Shiny with flagged proteins
plots <- QC_pseudo_array_grid_function(
  sample = input$selected_sample,
  datCollate = values$datCollate,
  data_type = input$data_type,
  scale = input$scale,
  show_flags = input$show_flags,
  flagged_proteins = input$flaggedProteins,
  selected_proteins = input$selected_protein
)
}

}
\seealso{
\code{\link{dat_GPR_BG_single_function}} for background plots
\code{\link{dat_GPR_FG_single_function}} for foreground plots
\code{\link{dat_GPR_NetI_single_function}} for net intensity plots
}
\author{
DrGarnett
}
