% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/limma_functions.R
\name{limma_analysis}
\alias{limma_analysis}
\title{Run Limma Differential Expression Analysis}
\usage{
limma_analysis(
  eSet,
  variable,
  feature_select = NULL,
  covariate1 = NULL,
  covariate2 = NULL,
  user_contrast = NULL,
  EB_trend = TRUE,
  EB_robust = TRUE,
  FC_cut = 1.1,
  p_val = 0.05
)
}
\arguments{
\item{eSet}{An ExpressionSet object with expression data and phenoData}

\item{variable}{Character string, column name in pData(eSet) for the main comparison variable}

\item{feature_select}{Character vector of feature names to analyze. Required.}

\item{covariate1}{Character string, optional first covariate column name from pData(eSet)}

\item{covariate2}{Character string, optional second covariate column name from pData(eSet)}

\item{user_contrast}{Optional contrast matrix created with makeContrasts()}

\item{EB_trend}{Logical, use eBayes trend parameter (default TRUE)}

\item{EB_robust}{Logical, use eBayes robust parameter for robustifying (default TRUE)}

\item{FC_cut}{Numeric, fold change cutoff threshold (default 1.1)}

\item{p_val}{Numeric, p-value threshold for significance (default 0.05)}
}
\value{
A list containing:
\describe{
\item{design}{Design matrix used in the linear model}
\item{topTable}{Full limma results table with all features}
\item{sig_features}{Character vector of significant feature names (p < p_val & |FC| > FC_cut)}
\item{fit}{eBayes fit object from limma}
\item{metadata}{Processed metadata (phenoData) used in analysis}
\item{expression}{Expression matrix used in analysis}
\item{variable}{Name of the main comparison variable}
\item{contrast_info}{List with contrast details (groups, sample sizes, contrast matrix)}
\item{p_threshold}{P-value threshold used}
\item{fc_threshold}{Fold change threshold used}
\item{sig_data}{Expression data for significant features only}
\item{sig_data_centered}{Row-centered expression data for significant features}
}
}
\description{
Performs differential expression analysis using limma on an ExpressionSet object.
Supports optional covariates, custom contrasts, and returns comprehensive results
including design matrix, top table, and significant features.
}
\details{
The function handles:
\itemize{
\item Automatic conversion of non-syntactic variable names using make.names()
\item Removal of samples with NA values in specified variables/covariates
\item Design matrix construction with or without covariates
\item Custom contrast specification or automatic coefficient selection
\item Feature filtering and sorting by p-value
}

For robust variance estimation, see Phipson et al. (2016) https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5373812/
}
\note{
Version 1.0.0
File: limma_function.R
}
\examples{
\dontrun{
# Basic usage without contrasts
results <- limma_analysis(
  eSet = my_eset,
  variable = "Sample_Group",
  feature_select = selected_features
)

# With custom contrast
my_contrast <- makeContrasts("case-control", levels = c("case", "control"))
results <- limma_analysis(
  eSet = my_eset,
  variable = "Sample_Group",
  feature_select = selected_features,
  user_contrast = my_contrast
)

# With covariates
results <- limma_analysis(
  eSet = my_eset,
  variable = "Sample_Group",
  feature_select = selected_features,
  covariate1 = "age",
  covariate2 = "gender"
)
}
}
