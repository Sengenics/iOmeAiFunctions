% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pseudoarray_functions.R
\name{single_grid_function}
\alias{single_grid_function}
\title{Generate Single Sample QC Grid Layout}
\usage{
single_grid_function(
  sample,
  datCollate,
  dat,
  QC,
  image_file_path = NULL,
  image_wavelength_index = 1,
  image_wavelength_title = NULL,
  slide_image_number = NULL,
  jpg_brightness = 100,
  pseudo_scale = "RFU",
  pseudo_data_type = c("all"),
  show_flags = TRUE,
  flagged_proteins = NULL,
  selected_proteins = NULL,
  scale_mode = "auto_per_plot",
  custom_min = NULL,
  custom_max = NULL,
  point_size = 0.75,
  flagged_df,
  flagged_QC_type
)
}
\arguments{
\item{sample}{Character string specifying the sample name}

\item{datCollate}{List object containing experiment data with structure:
\itemize{
\item \code{manifest}: Data frame with sample information
\item \code{data$RawData}: Data frame with raw GPR data
\item \code{data$Data}: Data frame with protein annotations
\item \code{param$Wavelength}: Character string ("532" or "635") specifying wavelength
}}

\item{dat}{List object containing GPR file data with structure:
\itemize{
\item \code{data$gpr[[gpr_name]]$GPR_edit}: Data frame with edited GPR data including Block info
}}

\item{QC}{List object containing QC data for density plots}

\item{image_file_path}{Character string specifying the path to the TIFF image file.
If NULL or file doesn't exist, the grid layout will be adjusted to exclude the image}

\item{image_wavelength_index}{Integer specifying which wavelength/page of the TIFF
to display. Default is 1}

\item{jpg_brightness}{Numeric value for image brightness adjustment (0-200).
Default is 100 (no change)}

\item{pseudo_scale}{Character string specifying scale type for pseudo arrays:
"RFU" for linear or "Log2" for log2-transformed. Default is "RFU"}

\item{pseudo_data_type}{Character vector specifying which data types to include
in pseudo arrays. Default is c('all')}

\item{show_flags}{Logical indicating whether to show quality flags as different
point shapes in the NetI plot. Default is TRUE}

\item{flagged_proteins}{Character vector of protein names that should be flagged.
Default is NULL}

\item{selected_proteins}{Character vector of protein names that should be highlighted.
Default is NULL}

\item{custom_min}{Numeric value for custom minimum scale limit. Default is NULL}

\item{custom_max}{Numeric value for custom maximum scale limit. Default is NULL}

\item{point_size}{Numeric value for point size in pseudo arrays. Default is 0.75}

\item{use_custom_scale}{Logical indicating whether to use custom scale limits.
Default is FALSE}
}
\value{
A grid.arrange object displaying the complete QC layout. The function
creates a grid with:
\itemize{
\item Top: Image info table (if image provided) and sample manifest table
\item Middle: TIFF image (if provided), flagged plot, density plot, control probe plot
\item Bottom: Three pseudo arrays (BG, FG, NetI) side by side
}
}
\description{
Creates a comprehensive quality control grid layout for a single sample,
including manifest information, TIFF image, quality metrics plots, density
plots, control probe plots, and pseudo array visualizations (BG, FG, NetI).
}
\details{
The layout adapts based on:
\enumerate{
\item \strong{Number of blocks}: Adjusts plot dimensions based on array block count
\itemize{
\item Single block (1): Uses larger pseudo array dimensions (1204 Ã 512)
\item Multiple blocks (>1): Scales dimensions proportionally (512 / n_blocks)
}
\item \strong{Image availability}:
\itemize{
\item With image: Full layout including image display area
\item Without image: Condensed layout without image row
}
}

The function uses complex grid layouts with different proportions:
\itemize{
\item With image: 6:27 ratio for tables, various ratios for plots
\item Without image: Full-width tables and plots
}

Image processing:
\itemize{
\item Loads TIFF using helper function \code{get_slide_images_function}
\item Applies brightness adjustment using \code{magick::image_modulate}
\item Converts to rasterGrob for grid display
}
}
\examples{
\dontrun{
# Basic usage with image
grid_plot <- single_grid_function(
  sample = "Sample1",
  datCollate = datCollate,
  dat = dat,
  QC = QC,
  image_file_path = "path/to/image.tif"
)

# Without image
grid_plot <- single_grid_function(
  sample = "Sample1",
  datCollate = datCollate,
  dat = dat,
  QC = QC,
  image_file_path = NULL
)

# With custom pseudo array settings
grid_plot <- single_grid_function(
  sample = "Sample1",
  datCollate = datCollate,
  dat = dat,
  QC = QC,
  image_file_path = "path/to/image.tif",
  pseudo_scale = "Log2",
  pseudo_data_type = c('feature'),
  show_flags = TRUE,
  jpg_brightness = 120
)

# In Shiny server
output$qc_grid <- renderPlot({
  single_grid_function(
    sample = input$selected_sample,
    datCollate = values$datCollate,
    dat = values$dat,
    QC = values$QC,
    image_file_path = input$image_path,
    image_wavelength_index = input$image_wavelength_index,
    jpg_brightness = input$jpg_brightness,
    pseudo_scale = input$single_pseudo_scale,
    pseudo_data_type = input$single_pseudo_data_type,
    show_flags = input$single_Flags,
    flagged_proteins = input$flaggedProteins,
    selected_proteins = input$single_label_protein
  )
})
}

}
\seealso{
\code{\link{QC_pseudo_array_grid_function}} for pseudo array generation
\code{\link{single_manifest_function}} for manifest extraction
\code{\link{create_bg_fg_density_plot}} for density plots
}
\author{
DrGarnett
}
