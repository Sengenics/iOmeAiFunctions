% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Batch_effect_functions.R
\name{permanova_function}
\alias{permanova_function}
\title{PERMANOVA Test for Batch Effects Using adonis2}
\usage{
permanova_function(
  m,
  meta,
  col_name,
  method = "euclidean",
  permutations = 199,
  by = "margin",
  use_parallel = TRUE
)
}
\arguments{
\item{m}{Numeric matrix.  Expression data with features in rows and samples
in columns.  Typically from \code{Biobase::exprs(ExpressionSet)}.}

\item{meta}{Data frame. Sample metadata with annotations in columns and
samples in rows.   Row names must match column names of \code{m}.}

\item{col_name}{Character string.  Column name in \code{meta} defining groups
to test for batch effects.}

\item{method}{Character.  Distance method (default "euclidean").  See
\code{vegan::vegdist} for options.}

\item{permutations}{Integer. Number of permutations (default 999).}

\item{by}{Character. Type of analysis: "terms" (sequential) or "margin"
(marginal, order-independent).  Default "margin".}
}
\value{
adonis2 result object with components:
\describe{
\item{Df}{Degrees of freedom}
\item{SumOfSqs}{Sum of squares}
\item{R2}{R-squared (proportion of variance explained)}
\item{F}{F-statistic}
\item{Pr(>F)}{P-value from permutation test}
}
}
\description{
Performs PERMANOVA (adonis2) to test whether groups differ significantly
in their expression profiles, indicating potential batch effects.
}
\details{
PERMANOVA (Permutational Multivariate Analysis of Variance) tests whether
groups have different centroids in multivariate space. Unlike betadisper
(which tests dispersion), this tests location differences.

The function:
\enumerate{
\item Row-scales the expression matrix using \code{row_scale_function()}
\item Transposes data (samples as rows)
\item Runs adonis2 PERMANOVA test
}
}
\examples{
\dontrun{
library(Biobase)
data(sample_ExpressionSet)

m <- exprs(sample_ExpressionSet)
meta <- pData(sample_ExpressionSet)

# Test for batch effects
result <- permanova_function(m, meta, "type")
print(result)
}
}
\seealso{
\code{\link{permanova_tidy_function}} for testing multiple annotations
\code{\link{anova_betadine_function}} for betadisper approach
\code{\link[vegan]{adonis2}} for PERMANOVA details
}
