% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/density_plot_functions.R
\name{calculate_bg_fg_stats}
\alias{calculate_bg_fg_stats}
\title{Calculate Background and Foreground Quality Control Statistics}
\usage{
calculate_bg_fg_stats(datCollate, apply_log2 = TRUE, min_spot_count = 20)
}
\arguments{
\item{datCollate}{A list containing data collection objects with components:
\itemize{
\item \code{data$RawData}: Data.frame with columns Labels, Sample, Protein, BG, FG, NetI
\item \code{data$Data}: Data.frame with columns Protein, data (feature/ctrl), mean
\item \code{param$BG_overlap_metric}: Character specifying metric type (e.g., "Mode_sd", "Median_mad")
\item \code{param$BG_FG_sd_mutiple}: Numeric multiplier for SD/MAD threshold (default 3)
}}

\item{apply_log2}{Logical indicating whether to apply log2 transformation. Default is TRUE}

\item{min_spot_count}{Integer minimum number of spots required per sample. Default is 20}
}
\value{
A list with two components:
\itemize{
\item \code{BGFG_stats}: Data.frame with QC statistics per sample including:
mean, mode, median, SD, MAD, CV, BG_overlap threshold, pepper count,
BG overlap percentages
\item \code{plot_data}: Data.frame in long format ready for density plotting
}
}
\description{
Computes comprehensive quality control statistics for background (BG) and
foreground (FG) signal intensities from raw microarray data. Calculates
distribution metrics, overlap thresholds, and identifies outlier artifacts.
}
\details{
The function performs the following steps:
\enumerate{
\item Filters raw data to include only feature spots (excludes controls)
\item Applies log2 transformation to BG, FG, and NetI values
\item Calculates distribution statistics (mean, mode, median, SD, MAD)
\item Computes BG overlap threshold based on specified metric:
\itemize{
\item Mode/Median/Mean_sd: uses standard deviation
\item Mode/Median/Mean_mad: uses median absolute deviation
}
\item Identifies "pepper" artifacts (intensities > mode + 2*SD)
\item Calculates percentage of spots with BG overlap
}

BG_overlap_metric examples:
\itemize{
\item "Mode_sd": FG_mode - (multiplier * FG_sd)
\item "Median_mad": FG_median - (multiplier * FG_mad)
\item "Mean_sd": FG_mean - (multiplier * FG_sd)
}
}
\examples{
\dontrun{
# Calculate BG/FG statistics
qc_results <- calculate_bg_fg_stats(
  datCollate = datCollate,
  apply_log2 = TRUE,
  min_spot_count = 20
)

# Access statistics
stats_df <- qc_results$BGFG_stats
plot_data <- qc_results$plot_data
}
Note : used to be
}
