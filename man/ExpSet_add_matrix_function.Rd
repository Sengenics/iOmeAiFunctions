% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ExpSet_functions.R
\name{ExpSet_add_matrix_function}
\alias{ExpSet_add_matrix_function}
\title{Add a Matrix to an ExpressionSet as a New Assay}
\usage{
ExpSet_add_matrix_function(ExpSet, matrix, name)
}
\arguments{
\item{ExpSet}{An ExpressionSet object to which the matrix will be added}

\item{matrix}{A matrix to add as a new assay. Must contain at least the same
feature names (rownames) and sample names (column names) as the ExpressionSet,
though it can contain additional features/samples that will be filtered out.}

\item{name}{Character string specifying the name for the new assay. This will
be used to access the assay later (e.g., via \code{assayData(ExpSet)[[name]]})}
}
\value{
An ExpressionSet object with the new matrix added as an assay. The
returned ExpressionSet will have the same features and samples as the input,
with the new assay added to the assayData slot.
}
\description{
This function adds a new matrix to an existing ExpressionSet object as an
additional assay. The matrix is automatically subset and reordered to match
the features (rows) and samples (columns) of the ExpressionSet.
}
\details{
The function performs the following steps:
\enumerate{
\item Extracts all current assay data from the ExpressionSet
\item Subsets and reorders the input matrix to match the ExpressionSet's
feature names (rows) and sample names (columns)
\item Adds the subset matrix to the assay data list with the specified name
\item Reconstructs the ExpressionSet with the updated assay data
}

The matrix subsetting ensures that:
\itemize{
\item Only features present in the ExpressionSet are included
\item Only samples present in the ExpressionSet are included
\item Features and samples are in the same order as the ExpressionSet
}
}
\note{
\itemize{
\item The input matrix must contain all features (rownames) present in the
ExpressionSet, otherwise subsetting will fail
\item The input matrix must contain all samples (column names matching
\code{rownames(pData(ExpSet))}) present in the ExpressionSet
\item If the matrix has extra features or samples not in the ExpressionSet,
they will be automatically filtered out
}
}
\examples{
\dontrun{
# Create an example ExpressionSet
library(Biobase)
data <- matrix(rnorm(100), nrow = 10, ncol = 10)
rownames(data) <- paste0("Gene", 1:10)
colnames(data) <- paste0("Sample", 1:10)
eset <- ExpressionSet(assayData = data)

# Create a new matrix to add (e.g., normalized data)
norm_data <- log2(data + 1)
rownames(norm_data) <- rownames(data)
colnames(norm_data) <- colnames(data)

# Add the normalized data as a new assay
eset <- ExpSet_add_matrix_function(eset, norm_data, "log2_norm")

# Access the new assay
log2_norm_data <- assayData(eset)[["log2_norm"]]

# Or use assayDataElement
log2_norm_data <- Biobase::assayDataElement(eset, "log2_norm")
}

}
\seealso{
\code{\link[Biobase]{ExpressionSet}},
\code{\link[Biobase]{assayData}},
\code{\link[Biobase]{assayDataNew}}
}
