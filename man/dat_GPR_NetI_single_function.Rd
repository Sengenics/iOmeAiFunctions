% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pseudoarray_functions.R
\name{dat_GPR_NetI_single_function}
\alias{dat_GPR_NetI_single_function}
\title{Plot Net Intensity Pseudo Array with Quality Flags}
\usage{
dat_GPR_NetI_single_function(
  sample,
  datCollate,
  wavelength = wavelength,
  flagged_proteins = NULL,
  selected_proteins = NULL,
  selected_data_type = "all",
  scale = "RFU",
  point_size = 0.75,
  scale_mode = "auto_per_plot",
  custom_min = NULL,
  custom_max = NULL,
  show_flags = TRUE
)
}
\arguments{
\item{sample}{Character string specifying the sample name}

\item{datCollate}{List object containing experiment data with structure:
\itemize{
\item \code{manifest}: Data frame with sample information
\item \code{data$RawData}: Data frame with raw GPR data (columns: Sample, X, Y, NetI,
Block, Row, Column, spot, Flags, Dia., Protein)
\item \code{data$Data}: Data frame with protein annotations and flags (columns:
Sample, Protein, data, flag, num_test)
\item \code{param$Wavelength}: Character string ("532" or "635") specifying wavelength
}}

\item{flagged_proteins}{Character vector of protein names that should be flagged.
Default is NULL}

\item{selected_proteins}{Character vector of protein names that should be highlighted.
Default is NULL}

\item{selected_data_type}{Character string specifying data types to display:
\itemize{
\item "all": includes feature, ctrl, failed, flagged, selected
\item "feature": includes feature, failed, flagged, selected (excludes ctrl)
Default is "all"
}}

\item{scale}{Character string specifying scale type: "RFU" for linear or
"Log2" for log2-transformed. Default is "RFU"}

\item{point_size}{Numeric value for base point size. Actual size is scaled
by spot diameter if available. Default is 0.75}

\item{custom_min}{Numeric value for custom minimum scale limit. Default is NULL}

\item{custom_max}{Numeric value for custom maximum scale limit. Default is NULL}

\item{show_flags}{Logical indicating whether to show quality flags as different
point shapes. Default is TRUE}

\item{use_custom_scale}{Logical indicating whether to use custom scale limits.
Default is FALSE}
}
\value{
A ggplot object showing the net intensity pseudo array with:
\itemize{
\item Fill color representing NetI values (black to wavelength color gradient)
\item Point shapes indicating quality flags (if show_flags = TRUE)
\item Point colors indicating spot categories (feature, ctrl, flagged, etc.)
\item Size scaled by spot diameter
\item Non-feature spots shown as hollow squares
\item Black background theme
\item Reversed y-axis to match array orientation
}
}
\description{
Creates a comprehensive pseudo array visualization of net intensity (NetI) values
with quality flags, spot categories, and customizable scaling. This is the most
feature-rich pseudo array plotting function.
}
\details{
Quality flag shapes (when show_flags = TRUE):
\itemize{
\item Circle (16): Good spots (Flags = 0)
\item Triangle (17): Poor morphology (Flags = -25)
\item Diamond (18): High background (Flags = -50)
\item Square (15): Low signal-to-noise (Flags = -75)
\item Asterisk (8): Not found (Flags = -100)
\item X (4): Other flags
}

Spot category colors (outline):
\itemize{
\item Gray: Pass
\item Blue: Outliers
\item Orange: Filtered/Negative spots
\item Black: Features
\item Wavelength color: Controls
\item White: Selected spots
}

The function automatically:
\itemize{
\item Scales point size by spot diameter (Dia. column) if available
\item Merges protein-level and spot-level flags
\item Handles flagged and selected proteins
\item Filters zero/negative values for log2 scale
}
}
\examples{
\dontrun{
# Basic NetI plot with auto-scaling
p <- dat_GPR_NetI_single_function("Sample1", datCollate)

# NetI plot with log2 scale, no flag shapes
p <- dat_GPR_NetI_single_function("Sample1", datCollate,
                                   scale = "Log2",
                                   show_flags = FALSE)

# NetI plot with custom scale matching TIFF images
p <- dat_GPR_NetI_single_function("Sample1", datCollate,
                                   use_custom_scale = TRUE,
                                   custom_min = 0,
                                   custom_max = 65535)

# Feature-only NetI plot with flagged proteins
p <- dat_GPR_NetI_single_function("Sample1", datCollate,
                                   selected_data_type = "feature",
                                   flagged_proteins = c("Protein1", "Protein2"))
}

}
\seealso{
\code{\link{dat_GPR_FG_single_function}}, \code{\link{dat_GPR_BG_single_function}}
}
\author{
DrGarnett
}
