% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/QC_plots.R
\name{select_ctrl_probe_plot_function}
\alias{select_ctrl_probe_plot_function}
\title{Plot Control Probe Intensities for Single Sample}
\usage{
select_ctrl_probe_plot_function(sample, datCollate)
}
\arguments{
\item{sample}{Character string specifying the sample name}

\item{datCollate}{List object containing experiment data with structure:
\itemize{
\item \code{data$RawData}: Data frame with raw GPR data containing columns:
Labels, Sample, Protein, BG, FG, NetI
}}

\item{ctrl_antibody_probes}{Character vector of protein names representing
detection antibody control probes (e.g., anti-IgG, anti-biotin).
Default is NULL (no antibody controls shown)}

\item{ctrl_BSA_probes}{Character vector of protein names representing
BSA control probes (e.g., Cy3-BSA, Cy5-BSA).
Default is NULL (no BSA controls shown)}
}
\value{
A ggplot object showing:
\itemize{
\item Boxplots of log2(NetI) for each control protein
\item Faceted by control type (Detection Antibody vs Cy3BSA)
\item Color-coded by control type
\item Free y-axis scales for each facet (allows different ranges)
\item X-axis labels hidden (protein names shown in legend/facet)
\item No legend (redundant with facet labels)
}
}
\description{
Creates a boxplot showing the distribution of net intensities for control
probes (detection antibody controls and BSA controls) in a single sample.
Useful for quality control to ensure controls are performing as expected.
}
\details{
This function visualizes the performance of positive control probes which
should show consistent, high signal across replicates. The controls are
separated into two categories:

\strong{Detection Antibody Controls:}
\itemize{
\item Probes with labeled detection antibodies (e.g., anti-IgG-Cy3)
\item Should show high, consistent signal
\item Used to verify detection reagent functionality
}

\strong{BSA Controls:}
\itemize{
\item Cy3-BSA or Cy5-BSA spotted directly on array
\item Should show very high, consistent signal
\item Used to verify scanner/imaging functionality
}

The function:
\itemize{
\item Filters raw data to the specified sample
\item Selects only control probes (antibody + BSA)
\item Classifies each probe into its control type
\item Plots log2(NetI) distributions as boxplots
\item Uses free y-scales since BSA typically has much higher signal than antibody controls
}

Interpretation:
\itemize{
\item Tight boxplots = good replicate consistency
\item High median values = good control performance
\item Outliers may indicate spot defects
}
}
\examples{
\dontrun{
# Basic usage
p <- select_ctrl_probe_plot_function(
  sample = "Sample1",
  datCollate = datCollate,
  ctrl_antibody_probes = c("Anti-IgG-Cy3", "Anti-Biotin-Cy3"),
  ctrl_BSA_probes = c("Cy3-BSA", "Cy5-BSA")
)

# With only antibody controls
p <- select_ctrl_probe_plot_function(
  sample = "Sample1",
  datCollate = datCollate,
  ctrl_antibody_probes = c("Anti-IgG-Cy3", "Anti-Biotin-Cy3"),
  ctrl_BSA_probes = NULL
)

# In Shiny with user-selected controls
output$ctrl_plot <- renderPlot({
  select_ctrl_probe_plot_function(
    sample = input$selected_sample,
    datCollate = values$datCollate,
    ctrl_antibody_probes = input$ctrl_antibody_probes,
    ctrl_BSA_probes = input$ctrl_BSA_probes
  )
})

# In single_grid_function
single_grid_function(
  sample = "Sample1",
  datCollate = datCollate,
  dat = dat,
  QC = QC,
  ctrl_antibody_probes = c("Anti-IgG-Cy3"),
  ctrl_BSA_probes = c("Cy3-BSA")
)
}

}
\seealso{
\code{\link{single_grid_function}} which uses this plot in QC layouts
\code{\link{single_flagged_plot_function}} for flagged spot metrics
}
\author{
DrGarnett
}
