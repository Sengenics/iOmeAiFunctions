% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/density_plot_functions.R
\name{create_density_plot}
\alias{create_density_plot}
\title{Create Density Plots for Background and Foreground Distributions}
\usage{
create_density_plot(
  density_plot_data,
  density_vline_data = NULL,
  sample_flag_data = NULL,
  flag_ylim = 2,
  col_num = 3,
  xlim = c(0, 16),
  facet = "Sample",
  scale = "auto"
)
}
\arguments{
\item{density_plot_data}{A data.frame containing the raw intensity data with columns:
Sample, BG, FG, NetI}

\item{density_vline_data}{A data.frame containing summary statistics for vertical reference
lines. Should include columns: Sample, BG, FG, BG_sd, BG_overlap, and optionally RFU_threshold}

\item{sample_flag_data}{Optional data.frame for flagged samples (currently not implemented)}

\item{flag_ylim}{Numeric value for y-axis limit when samples are flagged. Default is 2}

\item{col_num}{Integer specifying number of columns for faceting. Default is 3}

\item{xlim}{Numeric vector of length 2 specifying x-axis limits for log2 scale.
Default is c(0, 16)}

\item{facet}{Character string specifying faceting variable.
Use "Sample" for individual sample plots or any other value for aggregated view.
Default is "Sample"}

\item{scale}{Character string for scale type: "auto", "full", or "fixed".
When "full" or "fixed", applies coord_cartesian with xlim. Default is "auto"}
}
\value{
A ggplot2 object showing density distributions
}
\description{
Generates density plots showing the distribution of Background (BG), Foreground (FG),
and Net Intensity (NetI) values. Can be faceted by sample or show aggregated distributions.
}
\details{
When \code{facet = "Sample"}:
\itemize{
\item Creates separate density curves for each sample
\item BG shown in red, FG in blue, NetI in green
\item Dual y-axes: left for BG density, right for FG/NetI density (scaled)
\item Vertical reference lines show statistics from density_vline_data
}

When \code{facet != "Sample"}:
\itemize{
\item Shows aggregated densities across all samples
\item Individual samples shown as light colors, overall mean in bold
\item Vertical lines show mean statistics across samples
}

Reference lines:
\itemize{
\item Thick red line (alpha 0.25): BG statistic
\item Thin red line (alpha 1.0): BG + 1 standard deviation
\item Thick blue line (alpha 0.25): FG statistic
\item Thin blue line (alpha 1.0): BG overlap threshold
\item Thick black line (alpha 0.25): RFU threshold (if provided)
}
}
\examples{
\dontrun{
# Individual sample plots
plot <- create_density_plot(
  density_plot_data = raw_data,
  density_vline_data = stats_data,
  xlim = c(4, 12),
  facet = "Sample"
)

# Aggregated view
plot <- create_density_plot(
  density_plot_data = raw_data,
  density_vline_data = stats_data,
  xlim = c(4, 12),
  facet = "All"
)
}
Note used to be density_plot_function
}
