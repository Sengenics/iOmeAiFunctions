% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/denoiser_wrappers.R
\name{denoise_pipeline}
\alias{denoise_pipeline}
\title{Complete Denoising Pipeline}
\usage{
denoise_pipeline(
  eset,
  assay_name = NULL,
  n_PCs = 7,
  PN_column = "Sample_Group",
  PN_value = "Pooled Normal",
  PN_AAbs = NULL,
  exp_PN_AAbs = 6:12,
  cut_seq = seq(0.4, 3, 0.1),
  method = "singular",
  output_dir = "AAb_called",
  descriptor = "denoised",
  annotation_cols = c("Sample_Group"),
  save_results = TRUE
)
}
\arguments{
\item{eset}{ExpressionSet; ExpressionSet with expression data}

\item{assay_name}{Character; name of assay to use (default = NULL uses exprs())}

\item{n_PCs}{Integer; number of PCs to test (default = 7)}

\item{PN_column}{Character; metadata column identifying PN samples}

\item{PN_value}{Character; value identifying PN samples}

\item{PN_AAbs}{Character vector; expected PN AAbs from limma}

\item{exp_PN_AAbs}{Numeric vector; expected range of PN AAb count}

\item{cut_seq}{Numeric vector; cutpoint sequence to test}

\item{method}{Character; cutting method ("singular", "MAD", or "AAD")}

\item{output_dir}{Character; base output directory}

\item{descriptor}{Character; file descriptor}

\item{annotation_cols}{Character vector; columns for plot annotations}

\item{save_results}{Logical; whether to save results (default = TRUE)}
}
\value{
List containing:
\itemize{
\item \code{denoised_results}: Output from denoise_remove_PCs()
\item \code{cutpoint_results}: Data frame of all cutpoint analyses
\item \code{optimal_cutpoint}: Selected optimal parameters
\item \code{aab_called_data}: Final AAb-called matrix
\item \code{all_cutpoint_data}: List of AAb-called data for all tested cutpoints
}
}
\description{
Runs the complete denoising workflow: PC removal, cutpoint optimization,
and AAb calling. Suitable for use in AAb_caller_template.R
}
\examples{
results <- denoise_pipeline(
  eset = eset,
  assay_name = "NetI",
  PN_AAbs = c("PSIP1", "MAPK9", "MX1"),
  exp_PN_AAbs = 6:12,
  output_dir = "AAb_called",
  descriptor = "NetI_IgG"
)

# Access final AAb-called data
aab_data <- results$aab_called_data

}
