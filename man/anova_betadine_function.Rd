% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Batch_effect_functions.R
\name{anova_betadine_function}
\alias{anova_betadine_function}
\title{ANOVA Test for Batch Effects Using Beta Dispersion}
\usage{
anova_betadine_function(m, meta, col_name)
}
\arguments{
\item{m}{Numeric matrix.  Expression data with features in rows and samples
in columns.  Typically from \code{Biobase::exprs(ExpressionSet)}.}

\item{meta}{Data frame. Sample metadata with annotations in columns and
samples in rows.  Row names must match column names of \code{m}.
Typically from \code{Biobase::pData(ExpressionSet)}.}

\item{col_name}{Character string. Column name in \code{meta} defining groups
to test for batch effects (e.g., "Batch", "Sample_Group").}
}
\value{
ANOVA table (class \code{anova}) with the following components:
\describe{
\item{Df}{Degrees of freedom}
\item{Sum Sq}{Sum of squares}
\item{Mean Sq}{Mean sum of squares}
\item{F value}{F-statistic}
\item{Pr(>F)}{P-value}
}
}
\description{
Performs ANOVA on beta dispersion to test whether group dispersions differ
significantly, indicating potential batch effects in expression data.
}
\details{
The function performs the following steps:
\enumerate{
\item Row-scales the expression matrix using \code{row_scale_function()}
\item Calculates Euclidean distance matrix on transposed, scaled data
\item Computes beta dispersion using \code{vegan::betadisper()}
\item Performs ANOVA on dispersion to test for group differences
}

Beta dispersion measures the variability (spread) of samples within groups.
Significant ANOVA results indicate that groups have different dispersions,
which may suggest batch effects or technical variation.
}
\note{
\itemize{
\item Requires row names of \code{meta} to match column names of \code{m}
\item Column name with special characters (spaces, backticks) is handled
\item Prints the column name and constructed command for debugging
}

Original location: Batch_Effect_functions.R
}
\examples{
\dontrun{
# Using ExpressionSet
library(Biobase)
data(sample_ExpressionSet)

m <- exprs(sample_ExpressionSet)
meta <- pData(sample_ExpressionSet)

# Test for batch effects by sample type
anova_result <- anova_betadine_function(m, meta, "type")
print(anova_result)

# Check significance
if (anova_result$`Pr(>F)`[1] < 0.05) {
  message("Significant batch effect detected!")
}
}

}
\seealso{
\code{\link{anova_betadine_tidy_function}} for testing multiple annotations
\code{\link{row_scale_function}} for row scaling
\code{\link[vegan]{betadisper}} for beta dispersion analysis
}
