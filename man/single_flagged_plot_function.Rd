% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/QC_plots.R
\name{single_flagged_plot_function}
\alias{single_flagged_plot_function}
\title{Plot Flagged QC Metrics for Single Sample}
\usage{
single_flagged_plot_function(sample, flagged_df, flagged_QC_type = NULL)
}
\arguments{
\item{sample}{Character string specifying the sample name}

\item{flagged_df}{Data frame containing flagged QC metrics with columns:
\itemize{
\item \code{Sample}: Sample identifier
\item \code{metric}: QC metric type (e.g., "Saturated", "Negative", "Low Signal")
\item \code{value}: Percentage of spots flagged for this metric
\item \code{QC}: QC status ("pass" or "flag")
}}

\item{flagged_QC_type}{Character vector specifying which QC metric types to
display and their order. Examples: c("Saturated", "Negative", "Low Signal",
"High Background", "Poor Morphology"). Default is NULL (show all metrics)}
}
\value{
A ggplot object showing a horizontal bar chart with:
\itemize{
\item Y-axis: QC metric types (ordered by flagged_QC_type)
\item X-axis: Percentage of flagged spots
\item Fill color: QC status (pass = one color, flag = another)
\item Color palette: Brewer "Dark2" palette
\item No legend (colors self-explanatory in context)
}
}
\description{
Creates a horizontal bar chart showing the percentage of spots flagged for
various QC metrics (e.g., saturated, negative, low signal) for a single sample.
Color-coded by pass/fail status.
}
\details{
This function is designed for QC dashboards to quickly visualize which
quality metrics have the most flagged spots. The bars are stacked by
QC status (pass vs flag).

The function:
\itemize{
\item Filters to the specified sample
\item Filters to selected QC metric types (if specified)
\item Orders metrics according to flagged_QC_type vector
\item Uses factor levels to ensure all metrics show even if some have 0 values
\item Sets QC factor levels to c('pass', 'flag') for consistent coloring
}

Typical QC metrics include:
\itemize{
\item "Saturated": Spots with saturated pixels
\item "Negative": Spots with negative net intensity
\item "Low Signal": Spots below minimum signal threshold
\item "High Background": Spots with excessive background
\item "Poor Morphology": Spots with irregular shape
\item "Not Found": Spots that couldn't be detected
}
}
\examples{
\dontrun{
# Basic usage with default metrics
p <- single_flagged_plot_function("Sample1", flagged_df)

# With specific metrics in custom order
p <- single_flagged_plot_function(
  sample = "Sample1",
  flagged_df = QC_results$flagged_df,
  flagged_QC_type = c("Saturated", "Negative", "Low Signal")
)

# In Shiny with user-selected metrics
output$flagged_plot <- renderPlot({
  single_flagged_plot_function(
    sample = input$selected_sample,
    flagged_df = values$QC$flagged_df,
    flagged_QC_type = input$flagged_QC_type
  )
})

# Using with QC_Merge_PerSample output
qc_data <- QC_Merge_PerSample(datCollate, QC)
p <- single_flagged_plot_function(
  sample = "Sample1",
  flagged_df = qc_data$flagged_df,
  flagged_QC_type = c("Saturated", "Negative", "Low Signal", 
                      "High Background", "Poor Morphology")
)
}

}
\seealso{
\code{\link{QC_Merge_PerSample}} for generating flagged_df
\code{\link{single_grid_function}} which uses this plot in QC layouts
}
\author{
DrGarnett
}
